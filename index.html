<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hornet ‚Äî Interactive 3D</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: #181a1b;
      overflow: hidden;
    }
    model-viewer {
      width: 100%;
      height: 100%;
      display: block;
      --poster-color: transparent;
    }
    .hud {
      position: fixed;
      left: 12px;
      bottom: 12px;
      color: #fff;
      background: rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 999px;
      padding: 8px 12px;
      font: 14px system-ui, sans-serif;
      pointer-events: none;
    }
    .hud.right {
      left: auto;
      right: 12px;
    }
  </style>

  <!-- model-viewer script -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>

  <model-viewer id="mv"
    src="hornet.glb"
    camera-controls
    auto-rotate
    rotation-per-second="20deg"
    exposure="1.0"
    shadow-intensity="0.9"
    environment-image="neutral"
    interaction-prompt="auto"
    alt="Hornet 3D model">
  </model-viewer>

  <div class="hud">
    üñ±Ô∏è Left Click = Play animation ‚Ä¢ üñ±Ô∏è Double Click or Right Click = Reset Position
  </div>
  <div class="hud right" id="status">Loading‚Ä¶ 0%</div>

  <script type="module">
    const mv = document.getElementById('mv');
    const statusEl = document.getElementById('status');
    const ANIM_NAME = 'HORNET RIGAction';

    let initialPosition = null;
    let initialRotation = null;

    // progress HUD
    mv.addEventListener('progress', (e) => {
      const p = Math.round(100 * (e.detail?.totalProgress ?? 0));
      statusEl.textContent = p < 100 ? `Loading‚Ä¶ ${p}%` : 'Ready';
      if (p >= 100) setTimeout(() => statusEl.remove(), 1000);
    });

    mv.addEventListener('load', () => {
      console.log('‚úÖ Model loaded!');
      console.log('Available animations:', mv.availableAnimations);

      // Save initial position and rotation of the model
      const scene = mv.getScene();
      initialPosition = scene.position.clone();
      initialRotation = scene.rotation.clone();
    });

    // tiny helper for tweens
    function tween(duration, update, done){
      const t0 = performance.now();
      function frame(t){
        const u = Math.min(1, (t - t0) / duration);
        update(u);
        if (u < 1) requestAnimationFrame(frame);
        else if (done) done();
      }
      requestAnimationFrame(frame);
    }

    // LEFT CLICK ‚Üí Play animation
    mv.addEventListener('click', async () => {
      await mv.updateComplete;
      if (mv.availableAnimations?.includes(ANIM_NAME)) {
        mv.animationName = ANIM_NAME;
        mv.play();
        setTimeout(() => mv.pause(), 2000);
      } else {
        const scene = await mv.getScene();
        const head = scene.getNodeByName('Head') || scene;
        const base = head.rotation.y;
        tween(600, (u) => {
          head.rotation.y = base + Math.sin(u * Math.PI * 4) * 0.3 * (1 - u * 0.3);
        }, () => head.rotation.y = base);
      }
    });

    // DOUBLE CLICK or RIGHT CLICK ‚Üí Reset Position
    function resetPosition() {
      const scene = mv.getScene();
      tween(600, (u) => {
        scene.position.lerp(initialPosition, u);
        scene.rotation.set(
          THREE.MathUtils.lerp(initialRotation.x, scene.rotation.x, u),
          THREE.MathUtils.lerp(initialRotation.y, scene.rotation.y, u),
          THREE.MathUtils.lerp(initialRotation.z, scene.rotation.z, u)
        );
      }, () => {
        scene.position.copy(initialPosition);
        scene.rotation.copy(initialRotation);
      });
    }

    // DOUBLE CLICK ‚Üí Reset Position
    mv.addEventListener('dblclick', resetPosition);

    // RIGHT CLICK ‚Üí Reset Position (stop default context menu)
    mv.addEventListener('contextmenu', (e) => {
      e.preventDefault();
      resetPosition();
    });

    // error display
    mv.addEventListener('error', () => {
      const tried = new URL(mv.getAttribute('src'), location.href).href;
      console.error('‚ùå Model could not be loaded. Tried:', tried);
      alert('Model could not be loaded.\nOpen Console (F12) to see details.');
    });
  </script>

</body>
</html>
