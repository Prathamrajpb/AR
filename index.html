<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hornet ‚Äî 3D Demo</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: #181a1b;
      overflow: hidden;
    }
    model-viewer {
      width: 100%;
      height: 100%;
      display: block;
      --poster-color: transparent;
    }
    .hud {
      position: fixed;
      left: 12px;
      bottom: 12px;
      color: #fff;
      background: rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 999px;
      padding: 8px 12px;
      font: 14px system-ui, sans-serif;
      pointer-events: none;
    }
    .hud.right {
      left: auto;
      right: 12px;
    }
  </style>

  <!-- model-viewer script -->
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>

  <!-- 3D Viewer -->
  <model-viewer id="mv"
    src="hornet.glb"
    camera-controls
    auto-rotate
    rotation-per-second="20deg"
    exposure="1.0"
    shadow-intensity="0.9"
    environment-image="neutral"
    interaction-prompt="auto"
    alt="Hornet 3D model">
  </model-viewer>

  <div class="hud">üñ±Ô∏è Drag to rotate ‚Ä¢ üñ±Ô∏è Scroll to zoom ‚Ä¢ üëÜ Click to animate</div>
  <div class="hud right" id="status">Loading‚Ä¶ 0%</div>

  <script type="module">
    const mv = document.getElementById('mv');
    const statusEl = document.getElementById('status');
    const ANIM_NAME = 'HORNET RIGAction'; // the animation name from gltf.report

    // Loading progress display
    mv.addEventListener('progress', (e) => {
      const p = Math.round(100 * (e.detail?.totalProgress ?? 0));
      statusEl.textContent = p < 100 ? `Loading‚Ä¶ ${p}%` : 'Ready';
      if (p >= 100) setTimeout(() => statusEl.remove(), 1000);
    });

    // Show available animations in console
    mv.addEventListener('load', () => {
      console.log('‚úÖ Model loaded!');
      console.log('Available animations:', mv.availableAnimations);
    });

    // Click ‚Üí play animation or fallback head shake
    mv.addEventListener('click', async () => {
      await mv.updateComplete;
      if (Array.isArray(mv.availableAnimations) && mv.availableAnimations.includes(ANIM_NAME)) {
        mv.animationName = ANIM_NAME;
        mv.play();
        setTimeout(() => mv.pause(), 2000);
      } else {
        console.warn('‚ö†Ô∏è Animation not found ‚Äî doing small head wiggle instead.');
        const scene = await mv.getScene();
        const head = scene.getNodeByName('Head') || scene.getNodeByName('mixamorig:Head') || scene;
        const base = head.rotation.y;
        const start = performance.now();
        (function loop(t){
          const u = Math.min(1, (t - start) / 600);
          head.rotation.y = base + Math.sin(u * Math.PI * 4) * 0.3 * (1 - u * 0.3);
          if (u < 1) requestAnimationFrame(loop); else head.rotation.y = base;
        })(start);
      }
    });

    // Error handler (shows exact URL)
    mv.addEventListener('error', () => {
      const tried = new URL(mv.getAttribute('src'), location.href).href;
      console.error('‚ùå Model could not be loaded. Tried:', tried);
      alert('Model could not be loaded.\nOpen Console (F12) to see the exact URL.');
    });
  </script>

</body>
</html>
